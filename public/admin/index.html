<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Content Manager</title>
  <script>
    // Set manual init BEFORE loading CMS (must be set BEFORE CMS script loads)
    window.CMS_MANUAL_INIT = true;
    
    // Override the configuration after CMS loads
    window.addEventListener('load', function() {
      console.log('üîÑ Window loaded, checking for CMS override...');
      
      // Give CMS time to initialize with stub config, then override
      setTimeout(function() {
        if (window.CMS && window.CMS.registerPreviewTemplate) {
          console.log('üéØ CMS ready, applying structured configuration override...');
          
          // Force reinitialize with our structured config
          window.CMS.init({
            config: getStructuredConfig()
          });
        }
      }, 1000);
    });
    
    function getStructuredConfig() {
      console.log('üîß Building structured CMS config...');
      
      return {
        backend: {
          name: 'github',
          repo: 'lukegiuff/ObsessedWithSuccess',
          branch: 'main',
          base_url: 'https://decap-proxy-obsessedwithsuccess.giuffa88.workers.dev',
          auth_endpoint: '/auth'
        },
        local_backend: false,
        site_url: 'https://owsconsultinggroup.com',
        display_url: 'https://owsconsultinggroup.com',
        media_folder: 'public/assets/images',
        public_folder: '/assets/images',
        collections: [
          {
            name: 'pages',
            label: 'Pages',
            folder: 'content/pages',
            create: true,
            slug: '{{slug}}',
            fields: [
              {label: 'Title', name: 'title', widget: 'string'},
              {label: 'Description', name: 'description', widget: 'text', required: false},
              {label: 'Featured Image', name: 'featured_image', widget: 'image', required: false},
              {label: 'Hero Quote', name: 'hero_quote', widget: 'text', required: false, hint: 'Main hero section quote'},
              {
                label: 'Services',
                name: 'services',
                widget: 'object',
                fields: [
                  {label: 'Section Intro', name: 'intro', widget: 'text', default: 'Comprehensive talent solutions backed by real-world experience and industry expertise.'},
                  {
                    label: 'Service Items',
                    name: 'items',
                    widget: 'list',
                    fields: [
                      {label: 'Service Title', name: 'title', widget: 'string'},
                      {label: 'Service Description', name: 'description', widget: 'text'}
                    ]
                  }
                ]
              },
              {
                label: 'About Our Approach',
                name: 'about_approach',
                widget: 'object',
                fields: [
                  {label: 'Section Title', name: 'title', widget: 'string', default: 'About Our Approach'},
                  {label: 'Introduction', name: 'intro', widget: 'text'},
                  {
                    label: 'Key Points',
                    name: 'points',
                    widget: 'list',
                    field: {label: 'Point', name: 'point', widget: 'string'}
                  }
                ]
              },
              {
                label: 'The Difference Section',
                name: 'difference_section',
                widget: 'object',
                fields: [
                  {label: 'Section Title', name: 'title', widget: 'string', default: 'The'},
                  {label: 'Section Subtitle', name: 'subtitle', widget: 'string', default: 'Difference', hint: 'Highlighted word in title'},
                  {
                    label: 'Traditional Recruiting',
                    name: 'traditional',
                    widget: 'object',
                    fields: [
                      {label: 'Title', name: 'title', widget: 'string', default: 'Traditional Recruiting'},
                      {
                        label: 'Points',
                        name: 'points',
                        widget: 'list',
                        field: {label: 'Point', name: 'point', widget: 'string'}
                      }
                    ]
                  },
                  {
                    label: 'Our Approach',
                    name: 'our_approach',
                    widget: 'object',
                    fields: [
                      {label: 'Title', name: 'title', widget: 'string', default: 'Our Approach'},
                      {
                        label: 'Points',
                        name: 'points',
                        widget: 'list',
                        field: {label: 'Point', name: 'point', widget: 'string'}
                      }
                    ]
                  },
                  {label: 'Bottom Quote', name: 'quote', widget: 'text', default: 'We don\'t just place candidates. We elevate careers and transform organizations through the power of experience-driven insight.'}
                ]
              },
              {
                label: 'Contact Section',
                name: 'contact_section',
                widget: 'object',
                fields: [
                  {label: 'Section Title', name: 'title', widget: 'string', default: 'Start the'},
                  {label: 'Section Subtitle', name: 'subtitle', widget: 'string', default: 'Conversation', hint: 'Highlighted word in title'},
                  {label: 'Introduction Text', name: 'intro', widget: 'text'},
                  {
                    label: 'What to Expect',
                    name: 'expectations',
                    widget: 'list',
                    field: {label: 'Expectation', name: 'expectation', widget: 'string'}
                  },
                  {label: 'CTA Button Text', name: 'cta_text', widget: 'string', default: 'Schedule a Consultation'},
                  {label: 'Email Subject', name: 'email_subject', widget: 'string', default: 'Talent Strategy Consultation'}
                ]
              },
              {
                label: 'Call to Action',
                name: 'call_to_action',
                widget: 'object',
                fields: [
                  {label: 'Section Title', name: 'title', widget: 'string', default: 'Experience the Technology Difference'},
                  {label: 'Content', name: 'content', widget: 'text'}
                ]
              },
              {label: 'Body (Legacy)', name: 'body', widget: 'markdown', required: false, hint: 'Legacy markdown content - all content should now use structured fields above'}
            ]
          }
        ]
      };
    }
    
    // Debug logging  
    console.log('üîß CMS Manual Init Setup');
    console.log('üìç Current URL:', window.location.href);
    console.log('üìÇ Base URL:', window.location.origin);
    console.log('üè† Pathname:', window.location.pathname);
    
    // Test config.yml accessibility
    fetch('/config.yml')
      .then(response => {
        console.log('‚úÖ Root config.yml fetch response:', response.status, response.statusText);
        return response.text();
      })
      .then(text => {
        console.log('üìÑ Root config.yml content length:', text.length);
      })
      .catch(error => {
        console.error('‚ùå Root config.yml fetch error:', error);
      });
  </script>
</head>
<body>
  <div id="nc-root"></div>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
</body>
</html>